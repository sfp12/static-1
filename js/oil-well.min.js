$(function(){var e={};var h="";var d=function(i,o,m,j,n,l,k){Handsontable.renderers.TextRenderer.apply(this,arguments);o.innerHTML='<span style="margin-right: 200px">值班人 第一班：</span><span style="margin-right: 200px">第二班：</span><span style="margin-right: 200px">第三班：</span>'};var g=[["生产班次","生产时间(h:m)","电流(A)","产量","","","","","","","","井口压力(h)","","","井口温度(℃)","站温(℃)","站压((Mpa))","单井伴热(掺液)","","取样",""],["","","上电流/下电流","标高(cm)","量油时间(h:m:s)","","流量计(m³)/大罐液位(m)","液量(t/d)","测气","","气量(m³/d)","油压","套压","回压","","","","来水温度/回水温度℃","掺液(m³/d)","时间(h:min)","地点"],["","","","","起","止","","","分压(Mpa)","流量(m³)","","","","","","","","","","",""],["第一班","08:00","","","","","","","","","","","","","","","","","","",""],["","10:00","","","","","","","","","","","","","","","","","","",""],["","12:00","","","","","","","","","","","","","","","","","","",""],["","14:00","","","","","","","","","","","","","","","","","","",""],["第二班","16:00","","","","","","","","","","","","","","","","","","",""],["","18:00","","","","","","","","","","","","","","","","","","",""],["","20:00","","","","","","","","","","","","","","","","","","",""],["","22:00","","","","","","","","","","","","","","","","","","",""],["第三班","00:00","","","","","","","","","","","","","","","","","","",""],["","02:00","","","","","","","","","","","","","","","","","","",""],["","04:00","","","","","","","","","","","","","","","","","","",""],["","06:00","","","","","","","","","","","","","","","","","","",""],["日计","","","","","","","","","","","","","","","","","","","",""],["备注","","","","","","","","","","","","","","","","","","","",""],["包括","","","","","","","","","","","","","","","","","","","",""],["值班人","","","","","","","","","","","","","","","","","","","",""],];var c=document.getElementById("table");var f=function(){h=new Handsontable(c,{data:g,rowHeaders:false,colHeaders:false,mergeCells:[{"row":0,"col":0,"rowspan":3,"colspan":1},{"row":0,"col":1,"rowspan":3,"colspan":1},{"row":0,"col":3,"rowspan":1,"colspan":8},{"row":0,"col":11,"rowspan":1,"colspan":3},{"row":0,"col":14,"rowspan":3,"colspan":1},{"row":0,"col":15,"rowspan":3,"colspan":1},{"row":0,"col":16,"rowspan":3,"colspan":1},{"row":0,"col":17,"rowspan":1,"colspan":2},{"row":0,"col":19,"rowspan":1,"colspan":2},{"row":1,"col":2,"rowspan":2,"colspan":1},{"row":1,"col":3,"rowspan":2,"colspan":1},{"row":1,"col":4,"rowspan":1,"colspan":2},{"row":1,"col":6,"rowspan":2,"colspan":1},{"row":1,"col":7,"rowspan":2,"colspan":1},{"row":1,"col":8,"rowspan":1,"colspan":2},{"row":1,"col":10,"rowspan":2,"colspan":1},{"row":1,"col":11,"rowspan":2,"colspan":1},{"row":1,"col":12,"rowspan":2,"colspan":1},{"row":1,"col":13,"rowspan":2,"colspan":1},{"row":1,"col":17,"rowspan":2,"colspan":1},{"row":1,"col":18,"rowspan":2,"colspan":1},{"row":1,"col":19,"rowspan":2,"colspan":1},{"row":1,"col":20,"rowspan":2,"colspan":1},{"row":3,"col":0,"rowspan":4,"colspan":1},{"row":7,"col":0,"rowspan":4,"colspan":1},{"row":11,"col":0,"rowspan":4,"colspan":1},{"row":16,"col":0,"rowspan":1,"colspan":4},{"row":17,"col":0,"rowspan":1,"colspan":4},{"row":18,"col":0,"rowspan":1,"colspan":21},],cells:function(m,j,n){var l={};var i=this.instance.toVisualRow(m);var k=this.instance.toVisualColumn(j);if(i<3||k<2){l.readOnly=true}if(m===18&&j===0){l.renderer=d;l.readOnly=false}return l},})};var a=function(){e=data;var i=data.list;i.forEach(function(k,l){var m=k.Data;m.forEach(function(n,o){g[l*4+o+3][2]=n.UpperI+"/"+n.LowerI;g[l*4+o+3][3]=n.Elevation;g[l*4+o+3][4]=n.StartTime;g[l*4+o+3][5]=n.EndTime;g[l*4+o+3][6]=n.FlowmeterReading+"/"+n.LiquidLevel;g[l*4+o+3][7]=n.LiquidWeight;g[l*4+o+3][8]=n.GasPartialPressure;g[l*4+o+3][9]=n.GasFlow;g[l*4+o+3][10]=n.GasVolumetric;g[l*4+o+3][11]=n.TubingPressure;g[l*4+o+3][12]=n.CasingPressure;g[l*4+o+3][13]=n.ReturnPressure;g[l*4+o+3][14]=n.WellHeadFluidTemperature;g[l*4+o+3][15]=n.SatationTemperature;g[l*4+o+3][16]=n.SatationPressure;g[l*4+o+3][17]=n.inflowWaterTemperature+"/"+n.ReturnWaterTemperature;g[l*4+o+3][18]=n.BlendingVolume;g[l*4+o+3][19]=n.SamplingTime;g[l*4+o+3][20]=n.SamplingSpot})});var j=data.DailyTotal;g[15][2]=j.UpperI+"/"+j.LowerI;g[15][3]=j.Elevation;g[15][4]=j.StartTime;g[15][5]=j.EndTime;g[15][6]=j.FlowmeterReading+"/"+j.LiquidLevel;g[15][7]=j.LiquidWeight;g[15][8]=j.GasPartialPressure;g[15][9]=j.GasFlow;g[15][10]=j.GasVolumetric;g[15][11]=j.TubingPressure;g[15][12]=j.CasingPressure;g[15][13]=j.ReturnPressure;g[15][14]=j.WellHeadFluidTemperature;g[15][15]=j.SatationTemperature;g[15][16]=j.SatationPressure;g[15][17]=j.inflowWaterTemperature+"/"+j.ReturnWaterTemperature;g[15][18]=j.BlendingVolume;g[15][19]=j.SamplingTime;g[15][20]=j.SamplingSpot;f()};a();var b=function(){e.DailyTotal.UpperI=g[15][2].split("/")[0];e.DailyTotal.LowerI=g[15][2].split("/")[1];e.DailyTotal.Elevation=g[15][3];e.DailyTotal.StartTime=g[15][4];e.DailyTotal.EndTime=g[15][5];e.DailyTotal.FlowmeterReading=g[15][6].split("/")[0];e.DailyTotal.LiquidLevel=g[15][6].split("/")[1];e.DailyTotal.LiquidWeight=g[15][7];
e.DailyTotal.GasPartialPressure=g[15][8];e.DailyTotal.GasFlow=g[15][9];e.DailyTotal.GasVolumetric=g[15][10];e.DailyTotal.TubingPressure=g[15][11];e.DailyTotal.CasingPressure=g[15][12];e.DailyTotal.ReturnPressure=g[15][13];e.DailyTotal.WellHeadFluidTemperature=g[15][14];e.DailyTotal.SatationTemperature=g[15][15];e.DailyTotal.SatationPressure=g[15][16];e.DailyTotal.inflowWaterTemperature=g[15][17].split("/")[0];e.DailyTotal.ReturnWaterTemperature=g[15][17].split("/")[1];e.DailyTotal.BlendingVolume=g[15][18];e.DailyTotal.SamplingTime=g[15][19];e.DailyTotal.SamplingSpot=g[15][20];var i=e.list;i.forEach(function(j,k){var l=j.Data;l.forEach(function(m,n){m.UpperI=g[k*4+n+3][2].split("/")[0];m.LowerI=g[k*4+n+3][2].split("/")[1];m.Elevation=g[k*4+n+3][3];m.StartTime=g[k*4+n+3][4];m.EndTime=g[k*4+n+3][5];m.FlowmeterReading=g[k*4+n+3][6].split("/")[0];m.LiquidLevel=g[k*4+n+3][6].split("/")[1];m.LiquidWeight=g[k*4+n+3][7];m.GasPartialPressure=g[k*4+n+3][8];m.GasFlow=g[k*4+n+3][9];m.GasVolumetric=g[k*4+n+3][10];m.TubingPressure=g[k*4+n+3][11];m.CasingPressure=g[k*4+n+3][12];m.ReturnPressure=g[k*4+n+3][13];m.WellHeadFluidTemperature=g[k*4+n+3][14];m.SatationTemperature=g[k*4+n+3][15];m.SatationPressure=g[k*4+n+3][16];m.inflowWaterTemperature=g[k*4+n+3][17].split("/")[0];m.ReturnWaterTemperature=g[k*4+n+3][17].split("/")[1];m.BlendingVolume=g[k*4+n+3][18];m.SamplingTime=g[k*4+n+3][19];m.SamplingSpot=g[k*4+n+3][20]})})};setTimeout(function(){b()},3000)});