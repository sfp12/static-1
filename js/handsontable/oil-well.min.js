$(function(){var j={};var i="";var c=function(k,q,o,l,p,n,m){Handsontable.renderers.TextRenderer.apply(this,arguments);q.innerHTML='<span style="margin-right: 200px">值班人 第一班：</span><span style="margin-right: 200px">第二班：</span><span style="margin-right: 200px">第三班：</span>'};var d=[["生产班次","生产时间(h:m)","电流(A)","产量","","","","","","","","井口压力(h)","","","井口温度(℃)","站温(℃)","站压((Mpa))","单井伴热(掺液)","","取样",""],["","","上电流/下电流","标高(cm)","量油时间(h:m:s)","","流量计(m³)/大罐液位(m)","液量(t/d)","测气","","气量(m³/d)","油压","套压","回压","","","","来水温度/回水温度℃","掺液(m³/d)","时间(h:min)","地点"],["","","","","起","止","","","分压(Mpa)","流量(m³)","","","","","","","","","","",""],["第一班","08:00","","","","","","","","","","","","","","","","","","",""],["","10:00","","","","","","","","","","","","","","","","","","",""],["","12:00","","","","","","","","","","","","","","","","","","",""],["","14:00","","","","","","","","","","","","","","","","","","",""],["第二班","16:00","","","","","","","","","","","","","","","","","","",""],["","18:00","","","","","","","","","","","","","","","","","","",""],["","20:00","","","","","","","","","","","","","","","","","","",""],["","22:00","","","","","","","","","","","","","","","","","","",""],["第三班","00:00","","","","","","","","","","","","","","","","","","",""],["","02:00","","","","","","","","","","","","","","","","","","",""],["","04:00","","","","","","","","","","","","","","","","","","",""],["","06:00","","","","","","","","","","","","","","","","","","",""],["日计","","","","","","","","","","","","","","","","","","","",""],["备注","","","","","","","","","","","","","","","","","","","",""],["包括","","","","","","","","","","","","","","","","","","","",""],["值班人","","","","","","","","","","","","","","","","","","","",""],];var a=document.getElementById("table");var h=function(k,q,o,l,p,n,m){Handsontable.renderers.TextRenderer.apply(this,arguments);q.style.backgroundColor="#dcdcdc";if(o<3){q.style.fontWeight="bold"}};$("#btn").on("click",function(){var k=i.getPlugin("exportFile");k.downloadFile("csv",{filename:"油井日（班）报表"})});var f=function(){$(".container").width($($(".wtHider")[0]).width())};var g=function(){i=new Handsontable(a,{data:d,rowHeaders:false,colHeaders:false,mergeCells:[{"row":0,"col":0,"rowspan":3,"colspan":1},{"row":0,"col":1,"rowspan":3,"colspan":1},{"row":0,"col":3,"rowspan":1,"colspan":8},{"row":0,"col":11,"rowspan":1,"colspan":3},{"row":0,"col":14,"rowspan":3,"colspan":1},{"row":0,"col":15,"rowspan":3,"colspan":1},{"row":0,"col":16,"rowspan":3,"colspan":1},{"row":0,"col":17,"rowspan":1,"colspan":2},{"row":0,"col":19,"rowspan":1,"colspan":2},{"row":1,"col":2,"rowspan":2,"colspan":1},{"row":1,"col":3,"rowspan":2,"colspan":1},{"row":1,"col":4,"rowspan":1,"colspan":2},{"row":1,"col":6,"rowspan":2,"colspan":1},{"row":1,"col":7,"rowspan":2,"colspan":1},{"row":1,"col":8,"rowspan":1,"colspan":2},{"row":1,"col":10,"rowspan":2,"colspan":1},{"row":1,"col":11,"rowspan":2,"colspan":1},{"row":1,"col":12,"rowspan":2,"colspan":1},{"row":1,"col":13,"rowspan":2,"colspan":1},{"row":1,"col":17,"rowspan":2,"colspan":1},{"row":1,"col":18,"rowspan":2,"colspan":1},{"row":1,"col":19,"rowspan":2,"colspan":1},{"row":1,"col":20,"rowspan":2,"colspan":1},{"row":3,"col":0,"rowspan":4,"colspan":1},{"row":7,"col":0,"rowspan":4,"colspan":1},{"row":11,"col":0,"rowspan":4,"colspan":1},{"row":16,"col":0,"rowspan":1,"colspan":4},{"row":17,"col":0,"rowspan":1,"colspan":4},{"row":18,"col":0,"rowspan":1,"colspan":21},],cells:function(o,l,p){var n={};var k=this.instance.toVisualRow(o);var m=this.instance.toVisualColumn(l);if(k<3||m<2){n.readOnly=true;n.renderer=h}if(o===18&&l===0){n.renderer=c;n.readOnly=false}return n},})};var e=function(){j=data;var k=data.list;k.forEach(function(m,n){var o=m.Data;o.forEach(function(p,q){d[n*4+q+3][2]=p.UpperI+"/"+p.LowerI;d[n*4+q+3][3]=p.Elevation;d[n*4+q+3][4]=p.StartTime;d[n*4+q+3][5]=p.EndTime;d[n*4+q+3][6]=p.FlowmeterReading+"/"+p.LiquidLevel;d[n*4+q+3][7]=p.LiquidWeight;d[n*4+q+3][8]=p.GasPartialPressure;d[n*4+q+3][9]=p.GasFlow;d[n*4+q+3][10]=p.GasVolumetric;d[n*4+q+3][11]=p.TubingPressure;d[n*4+q+3][12]=p.CasingPressure;d[n*4+q+3][13]=p.ReturnPressure;d[n*4+q+3][14]=p.WellHeadFluidTemperature;d[n*4+q+3][15]=p.SatationTemperature;d[n*4+q+3][16]=p.SatationPressure;d[n*4+q+3][17]=p.inflowWaterTemperature+"/"+p.ReturnWaterTemperature;d[n*4+q+3][18]=p.BlendingVolume;d[n*4+q+3][19]=p.SamplingTime;d[n*4+q+3][20]=p.SamplingSpot})});var l=data.DailyTotal;d[15][2]=l.UpperI+"/"+l.LowerI;d[15][3]=l.Elevation;d[15][4]=l.StartTime;d[15][5]=l.EndTime;d[15][6]=l.FlowmeterReading+"/"+l.LiquidLevel;d[15][7]=l.LiquidWeight;d[15][8]=l.GasPartialPressure;d[15][9]=l.GasFlow;d[15][10]=l.GasVolumetric;d[15][11]=l.TubingPressure;d[15][12]=l.CasingPressure;d[15][13]=l.ReturnPressure;d[15][14]=l.WellHeadFluidTemperature;d[15][15]=l.SatationTemperature;d[15][16]=l.SatationPressure;d[15][17]=l.inflowWaterTemperature+"/"+l.ReturnWaterTemperature;d[15][18]=l.BlendingVolume;d[15][19]=l.SamplingTime;d[15][20]=l.SamplingSpot;
g();f()};e();var b=function(){j.DailyTotal.UpperI=d[15][2].split("/")[0];j.DailyTotal.LowerI=d[15][2].split("/")[1];j.DailyTotal.Elevation=d[15][3];j.DailyTotal.StartTime=d[15][4];j.DailyTotal.EndTime=d[15][5];j.DailyTotal.FlowmeterReading=d[15][6].split("/")[0];j.DailyTotal.LiquidLevel=d[15][6].split("/")[1];j.DailyTotal.LiquidWeight=d[15][7];j.DailyTotal.GasPartialPressure=d[15][8];j.DailyTotal.GasFlow=d[15][9];j.DailyTotal.GasVolumetric=d[15][10];j.DailyTotal.TubingPressure=d[15][11];j.DailyTotal.CasingPressure=d[15][12];j.DailyTotal.ReturnPressure=d[15][13];j.DailyTotal.WellHeadFluidTemperature=d[15][14];j.DailyTotal.SatationTemperature=d[15][15];j.DailyTotal.SatationPressure=d[15][16];j.DailyTotal.inflowWaterTemperature=d[15][17].split("/")[0];j.DailyTotal.ReturnWaterTemperature=d[15][17].split("/")[1];j.DailyTotal.BlendingVolume=d[15][18];j.DailyTotal.SamplingTime=d[15][19];j.DailyTotal.SamplingSpot=d[15][20];var k=j.list;k.forEach(function(l,m){var n=l.Data;n.forEach(function(o,p){o.UpperI=d[m*4+p+3][2].split("/")[0];o.LowerI=d[m*4+p+3][2].split("/")[1];o.Elevation=d[m*4+p+3][3];o.StartTime=d[m*4+p+3][4];o.EndTime=d[m*4+p+3][5];o.FlowmeterReading=d[m*4+p+3][6].split("/")[0];o.LiquidLevel=d[m*4+p+3][6].split("/")[1];o.LiquidWeight=d[m*4+p+3][7];o.GasPartialPressure=d[m*4+p+3][8];o.GasFlow=d[m*4+p+3][9];o.GasVolumetric=d[m*4+p+3][10];o.TubingPressure=d[m*4+p+3][11];o.CasingPressure=d[m*4+p+3][12];o.ReturnPressure=d[m*4+p+3][13];o.WellHeadFluidTemperature=d[m*4+p+3][14];o.SatationTemperature=d[m*4+p+3][15];o.SatationPressure=d[m*4+p+3][16];o.inflowWaterTemperature=d[m*4+p+3][17].split("/")[0];o.ReturnWaterTemperature=d[m*4+p+3][17].split("/")[1];o.BlendingVolume=d[m*4+p+3][18];o.SamplingTime=d[m*4+p+3][19];o.SamplingSpot=d[m*4+p+3][20]})})};setTimeout(function(){b()},3000)});