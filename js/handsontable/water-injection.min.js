$(function(){var h="";var i={};$("#btn").on("click",function(){var j=h.getPlugin("exportFile");j.downloadFile("csv",{filename:"站注水井日报表"})});var c=[["班次","时间","压力(Mpa)","","","水表读数(m³)","班注水量(m³)","备注"],["","","干压","油压","套压","上班底数:","",""],["第一班","08:00","","","","","",""],["","10:00","","","","","",""],["","12:00","","","","","",""],["","14:00","","","","","",""],["第二班","16:00","","","","","",""],["","18:00","","","","","",""],["","20:00","","","","","",""],["","22:00","","","","","",""],["第三班","00:00","","","","","",""],["","02:00","","","","","",""],["","04:00","","","","","",""],["","06:00","","","","","",""],["合计日注水量(m³)","","","","","","",""],];var a=document.getElementById("table");var g=function(j,p,n,k,o,m,l){Handsontable.renderers.TextRenderer.apply(this,arguments);p.style.backgroundColor="#dcdcdc";if(n<2){p.style.fontWeight="bold"}};var e=function(){$(".container").width($($(".wtHider")[0]).width())};var f=function(){h=new Handsontable(a,{data:c,rowHeaders:false,colHeaders:false,mergeCells:[{"row":0,"col":0,"rowspan":2,"colspan":1},{"row":0,"col":1,"rowspan":2,"colspan":1},{"row":0,"col":2,"rowspan":1,"colspan":3},{"row":0,"col":6,"rowspan":2,"colspan":1},{"row":0,"col":7,"rowspan":2,"colspan":1},{"row":2,"col":0,"rowspan":4,"colspan":1},{"row":2,"col":6,"rowspan":4,"colspan":1},{"row":2,"col":7,"rowspan":4,"colspan":1},{"row":6,"col":0,"rowspan":4,"colspan":1},{"row":6,"col":6,"rowspan":4,"colspan":1},{"row":6,"col":7,"rowspan":4,"colspan":1},{"row":10,"col":0,"rowspan":4,"colspan":1},{"row":10,"col":6,"rowspan":4,"colspan":1},{"row":10,"col":7,"rowspan":4,"colspan":1},{"row":14,"col":0,"rowspan":1,"colspan":2},{"row":14,"col":2,"rowspan":1,"colspan":5},],cells:function(n,k,o){var m={};var j=this.instance.toVisualRow(n);var l=this.instance.toVisualColumn(k);if(j<2||l<2){m.readOnly=true;m.renderer=g}return m},colWidths:function(j){if(j===7){return 200}return 100},})};var d=function(){c[14][2]=data.InjectionAllocation;i=data;var j=data.list;j.forEach(function(k,l){c[l*4+2][6]=k.TeamWaterInjection;c[l*4+2][7]=k.Remark;var m=k.Data;m.forEach(function(n,o){c[l*4+o+2][2]=n.TrunkPressure;c[l*4+o+2][3]=n.TubingPressure;c[l*4+o+2][4]=n.CasingPressure;c[l*4+o+2][5]=n.WaterMeterReading})});f();e()};d();var b=function(){i.InjectionAllocation=c[14][2];var j=i.list;j.forEach(function(k,l){k.TeamWaterInjection=c[l*4+2][6];k.Remark=c[l*4+2][7];var m=k.Data;m.forEach(function(n,o){n.TrunkPressure=c[l*4+o+2][2];n.TubingPressure=c[l*4+o+2][3];n.CasingPressure=c[l*4+o+2][4];n.WaterMeterReading=c[l*4+o+2][5]})})};setTimeout(function(){b()},3000)});