$(function(){var i={};var h="";var c=[["月","","工作时间(h)","","","","故障停机时间(h)","操作者"],["日期","班次","本班运转","累计运转","一保后运转","二保后运转",""],["1","8点","","","","","","",""],["","16-0点","","","","","","",""],["2","8点","","","","","","",""],["","16-0点","","","","","","",""],["3","8点","","","","","","",""],["","16-0点","","","","","","",""],["4","8点","","","","","","",""],["","16-0点","","","","","","",""],["5","8点","","","","","","",""],["","16-0点","","","","","","",""],["6","8点","","","","","","",""],["","16-0点","","","","","","",""],["7","8点","","","","","","",""],["","16-0点","","","","","","",""],["8","8点","","","","","","",""],["","16-0点","","","","","","",""],["9","8点","","","","","","",""],["","16-0点","","","","","","",""],["10","8点","","","","","","",""],["","16-0点","","","","","","",""],["11","8点","","","","","","",""],["","16-0点","","","","","","",""],["12","8点","","","","","","",""],["","16-0点","","","","","","",""],["13","8点","","","","","","",""],["","16-0点","","","","","","",""],["14","8点","","","","","","",""],["","16-0点","","","","","","",""],["15","8点","","","","","","",""],["","16-0点","","","","","","",""],["16","8点","","","","","","",""],["","16-0点","","","","","","",""],["17","8点","","","","","","",""],["","16-0点","","","","","","",""],["18","8点","","","","","","",""],["","16-0点","","","","","","",""],["19","8点","","","","","","",""],["","16-0点","","","","","","",""],["20","8点","","","","","","",""],["","16-0点","","","","","","",""],["21","8点","","","","","","",""],["","16-0点","","","","","","",""],["22","8点","","","","","","",""],["","16-0点","","","","","","",""],["23","8点","","","","","","",""],["","16-0点","","","","","","",""],["24","8点","","","","","","",""],["","16-0点","","","","","","",""],["25","8点","","","","","","",""],["","16-0点","","","","","","",""],["26","8点","","","","","","",""],["","16-0点","","","","","","",""],["27","8点","","","","","","",""],["","16-0点","","","","","","",""],["28","8点","","","","","","",""],["","16-0点","","","","","","",""],["28","8点","","","","","","",""],["","16-0点","","","","","","",""],["30","8点","","","","","","",""],["","16-0点","","","","","","",""],["31","8点","","","","","","",""],["","16-0点","","","","","","",""],["月度汇总","","完好天数","","累计故障","","本月累计",""],["","","工作天数","","加换油(L)","","汇总人",""],["备注","","","","","","","",""],];var a=document.getElementById("table");$("#btn").on("click",function(){var j=h.getPlugin("exportFile");j.downloadFile("csv",{filename:"设备运转记录"})});var g=function(j,p,n,k,o,m,l){Handsontable.renderers.TextRenderer.apply(this,arguments);p.style.backgroundColor="#dcdcdc";if(n<2){p.style.fontWeight="bold"}};var e=function(){$(".container").width($($(".wtHider")[0]).width())};var f=function(){h=new Handsontable(a,{data:c,rowHeaders:false,colHeaders:false,mergeCells:[{"row":0,"col":0,"rowspan":1,"colspan":2},{"row":0,"col":2,"rowspan":1,"colspan":4},{"row":0,"col":6,"rowspan":2,"colspan":1},{"row":0,"col":7,"rowspan":2,"colspan":1},{"row":2,"col":0,"rowspan":2,"colspan":1},{"row":4,"col":0,"rowspan":2,"colspan":1},{"row":6,"col":0,"rowspan":2,"colspan":1},{"row":8,"col":0,"rowspan":2,"colspan":1},{"row":10,"col":0,"rowspan":2,"colspan":1},{"row":12,"col":0,"rowspan":2,"colspan":1},{"row":14,"col":0,"rowspan":2,"colspan":1},{"row":16,"col":0,"rowspan":2,"colspan":1},{"row":18,"col":0,"rowspan":2,"colspan":1},{"row":20,"col":0,"rowspan":2,"colspan":1},{"row":22,"col":0,"rowspan":2,"colspan":1},{"row":24,"col":0,"rowspan":2,"colspan":1},{"row":26,"col":0,"rowspan":2,"colspan":1},{"row":28,"col":0,"rowspan":2,"colspan":1},{"row":30,"col":0,"rowspan":2,"colspan":1},{"row":32,"col":0,"rowspan":2,"colspan":1},{"row":34,"col":0,"rowspan":2,"colspan":1},{"row":36,"col":0,"rowspan":2,"colspan":1},{"row":38,"col":0,"rowspan":2,"colspan":1},{"row":40,"col":0,"rowspan":2,"colspan":1},{"row":42,"col":0,"rowspan":2,"colspan":1},{"row":44,"col":0,"rowspan":2,"colspan":1},{"row":46,"col":0,"rowspan":2,"colspan":1},{"row":48,"col":0,"rowspan":2,"colspan":1},{"row":50,"col":0,"rowspan":2,"colspan":1},{"row":52,"col":0,"rowspan":2,"colspan":1},{"row":54,"col":0,"rowspan":2,"colspan":1},{"row":56,"col":0,"rowspan":2,"colspan":1},{"row":58,"col":0,"rowspan":2,"colspan":1},{"row":60,"col":0,"rowspan":2,"colspan":1},{"row":62,"col":0,"rowspan":2,"colspan":1},{"row":64,"col":0,"rowspan":2,"colspan":2},{"row":66,"col":0,"rowspan":1,"colspan":8},],cells:function(n,k,o){var m={};var j=this.instance.toVisualRow(n);var l=this.instance.toVisualColumn(k);if(j<2||l<2){m.readOnly=true;m.renderer=g}return m},})};var d=function(){i=data;var j=data.list;j.forEach(function(k,l){var m=k.Data;m.forEach(function(n,o){if(l===30&&o===2){return false}c[l*2+o+2][2]=n.TeamRunningTime;c[l*2+o+2][3]=n.TotalRunningTime;c[l*2+o+2][4]=n.FirstMaintainRunningTime;c[l*2+o+2][5]=n.SecondMaintainRunningTime;c[l*2+o+2][6]=n.DownTime;c[l*2+o+2][7]=n.Handlers})});c[64][3]=data.MonthTotal.MonthTotalRunningDay;c[64][5]=data.MonthTotal.MonthTotalDownTime;c[64][7]=data.MonthTotal.MonthTotalRunningTime;c[65][3]=data.MonthTotal.MonthTotalDay;
c[65][5]=data.MonthTotal.MonthTotalOilChangeLitre;c[65][7]=data.MonthTotal.MonthTotalPerson;f();e()};d();var b=function(){i.MonthTotal.MonthTotalRunningDay=c[64][3];i.MonthTotal.MonthTotalDownTime=c[64][5];i.MonthTotal.MonthTotalRunningTime=c[64][7];i.MonthTotal.MonthTotalDay=c[65][3];i.MonthTotal.MonthTotalOilChangeLitre=c[65][5];i.MonthTotal.MonthTotalPerson=c[65][7];var j=i.list;j.forEach(function(k,l){var m=k.Data;m.forEach(function(n,o){if(l===30&&o===2){return false}n.TeamRunningTime=c[l*2+o+2][2];n.TotalRunningTime=c[l*2+o+2][3];n.FirstMaintainRunningTime=c[l*2+o+2][4];n.SecondMaintainRunningTime=c[l*2+o+2][5];n.DownTime=c[l*2+o+2][6];n.Handlers=c[l*2+o+2][7]})})};setTimeout(function(){b()},3000)});